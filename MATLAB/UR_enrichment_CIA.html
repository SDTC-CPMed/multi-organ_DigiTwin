<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2020b"><title>UR enrichment analysis of CIA</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: normal; text-align: left;  }
.S1 { margin-bottom: 20px; padding-bottom: 4px;  }
.S2 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: bold; text-align: start;  }
.S3 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: start;  }
.S4 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: bold; text-align: left;  }
.S9 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: bold; text-align: left;  }
.S10 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S11 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S12 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: normal; text-align: left;  }
.S14 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S15 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.embeddedOutputsVariableTableElement .ClientViewDiv table tr {height: 22px; white-space: nowrap;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr td,.embeddedOutputsVariableTableElement .ClientViewDiv table tr th {background-color:white; text-overflow: ellipsis; font-family: 'Arial', sans-serif; font-size: 12px; overflow : hidden;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr span {text-overflow: ellipsis; padding: 3px;}
.embeddedOutputsVariableTableElement .ClientViewDiv table tr th {color: rgba(0,0,0,0.5); padding: 3px; font-size: 9px;}
.S16 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: bold; text-align: left;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_3BBCC1A2' ><span>UR enrichment analysis of CIA</span></h1><div  class = 'S1'><div  class = 'S2'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S3'><a href = "#H_ABA800F9"><span>Input requirements
</span></a><span>    </span><a href = "#H_29D9EA9B"><span>For this analysis we will need:
</span></a><span>    </span><a href = "#H_229A39C3"><span>We can find the files at following locations:
</span></a><span>    </span><a href = "#H_77554A53"><span>We will produce
</span></a><span>    </span><a href = "#H_CD1D8F27"><span>We will save the file here:
</span></a><a href = "#H_8EEC0AFA"><span>Prepare the data
</span></a><span>    </span><a href = "#H_C9AE6352"><span>Load DEGs and translate the gene names to human orthologous.
</span></a><span>    </span><a href = "#H_CCE50919"><span>Load CIA_Ps and CIA_SPs from connective pathway analysis
</span></a><span>    </span><a href = "#H_BBBEC1DE"><span>load URs from Niche net
</span></a><a href = "#H_C543E7C0"><span>Main analysis 
</span></a><span>    </span><a href = "#H_DB504A76"><span>Fisher test enrichment of UR DS in SPs:
</span></a><span>    </span><a href = "#H_2E8C639C"><span>combine pvalues over joint and muscle:
</span></a><span>    </span><a href = "#H_BC696F3B"><span>FDR correction over Programs
</span></a><span>    </span><a href = "#H_0BDB29FB"><span>Count significant pvalues over joints and muscles:
</span></a><a href = "#H_C7F41035"><span>Final output
</span></a><span>    </span><a href = "#H_2899577C"><span>Save the data</span></a></div></div><div  class = 'S4'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>clear </span><span class="warning_squiggle_rte436651325" style="color: rgb(170, 4, 249);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>close </span><span style="color: rgb(170, 4, 249);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>clc</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>warning(</span><span style="color: rgb(170, 4, 249);">'off'</span><span>, </span><span style="color: rgb(170, 4, 249);">'all'</span><span>)</span></span></div></div></div><h2  class = 'S8' id = 'H_ABA800F9' ><span>Input requirements</span></h2><h4  class = 'S9' id = 'H_29D9EA9B' ><span>For this analysis we will need:</span></h4><ul  class = 'S10'><li  class = 'S11'><span>DEGs computed by (TODO link!)</span></li><li  class = 'S11'><span>Orthologous translation</span></li><li  class = 'S11'><span>Results from the connective pathway analysis (TODO link!)</span></li><li  class = 'S11'><span>Predicted URs and their downstreamers from Niche Net (TODO link!)</span></li></ul><h4  class = 'S9' id = 'H_229A39C3' ><span>We can find the files at following locations:</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% DEGs</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>path_DEGs = </span><span style="color: rgb(170, 4, 249);">'../data/CIA_mouse_DEGs/'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% translation</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>path_translation = </span><span style="color: rgb(170, 4, 249);">'../data/Connective_pathway_analysis/orthologous_translation_NicheNet_analysis.txt'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% connective pathway analysis</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>path_cpa = </span><span style="color: rgb(170, 4, 249);">'../data/Connective_pathway_analysis/TreeStructure_nodes2_scRNAseq.txt'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% URs </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>path_URs = </span><span style="color: rgb(170, 4, 249);">'../data/Connective_pathway_analysis/all_outgoing_ligand_activity.txt'</span><span>;</span></span></div></div></div><h4  class = 'S9' id = 'H_77554A53' ><span>We will produce</span></h4><div  class = 'S4'><span>A table with combined, FDR corrected pvalues and the count of significant p values across all cell types for each program/subprogram and UR </span></div><h4  class = 'S9' id = 'H_CD1D8F27' ><span>We will save the file here:</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre;"><span>path_output = </span><span style="color: rgb(170, 4, 249);">'../data/UR_analysis/UR_predictions_CIA_disease_Pvals.xlsx'</span><span>;</span></span></div></div></div><div  class = 'S13'><span></span></div><h2  class = 'S8' id = 'H_8EEC0AFA' ><span>Prepare the data</span></h2><div  class = 'S4'><span></span></div><h4  class = 'S9' id = 'H_C9AE6352' ><span>Load DEGs and translate the gene names to human orthologous.</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn = struct2cell(dir(path_DEGs));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn(2:end,:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn(~contains(Fn,</span><span style="color: rgb(170, 4, 249);">'.csv'</span><span>))=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn = table(Fn',</span><span style="color: rgb(170, 4, 249);">'variablenames'</span><span>,{</span><span style="color: rgb(170, 4, 249);">'fn'</span><span>});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.Cell = cellfun(@(x) x{5}, regexp(Fn.fn,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.Organ = cellfun(@(x) x{6}(1:end-4), regexp(Fn.fn,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn(~ismember(Fn.Organ,{</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>,</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>}),:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>translation = readtable(path_translation);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>z = 1 : length(Fn.fn)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   hv =readtable(sprintf(</span><span style="color: rgb(170, 4, 249);">'%s%s'</span><span>,path_DEGs,Fn.fn{z}));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   hv(~strcmp(hv.is_de_fdr_0_05,</span><span style="color: rgb(170, 4, 249);">'True'</span><span>),:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   xx= unique(translation(ismember(translation.Mouse_gene_name,hv.Var1),:));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   Fn.DEG{z} = xx.Gene_name;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   clear </span><span style="color: rgb(170, 4, 249);">hv xx</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Restructure the data</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.cell_dataset = cellfun(@(x) x{5},regexp(Fn.fn,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.Properties.VariableNames(strcmp(Fn.Properties.VariableNames,</span><span style="color: rgb(170, 4, 249);">'Organ'</span><span>))={</span><span style="color: rgb(170, 4, 249);">'Organ_condition'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.group = repmat({</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>},length(Fn.fn),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.group(strcmp(Fn.Organ_condition,</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>))={</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn.key = cellfun(@(x,y) sprintf(</span><span style="color: rgb(170, 4, 249);">'%s***%s'</span><span>,x,y),Fn.cell_dataset,Fn.group,</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>Fn = Fn(:,{</span><span style="color: rgb(170, 4, 249);">'key'</span><span>,</span><span style="color: rgb(170, 4, 249);">'cell_dataset'</span><span>,</span><span style="color: rgb(170, 4, 249);">'group'</span><span>,</span><span style="color: rgb(170, 4, 249);">'DEG'</span><span>});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>head(Fn, 5)</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableTableElement" uid="66A881FA" data-testid="output_0" style="width: 925px;"><div class="ClientDocument veSpecifier dijitContentPane document table" id="variableeditor_peer_RemoteDocument_80" widgetid="variableeditor_peer_RemoteDocument_80" tabindex="0" data-update-plain-text-string="true"><div class="summaryBar" style="font-size: 12px; font-family: Consolas, Inconsolata, Menlo, monospace;"><span>ans = </span><span style="color: rgb(179, 179, 179); font-style: normal;">5×4 table </span></div><div id="variableeditor_peer_RemoteTableViewModel_78" widgetid="variableeditor_peer_RemoteTableViewModel_78" class="table ClientViewDiv hasSummaryBar" data-viewid="__1"><table cellspacing="0" style="border-spacing: 0px; border-width: 0px 1px 0px 0px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><thead><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>&nbsp;</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>key</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>cell_dataset</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>group</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>DEG</span></th></tr></thead><tbody><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>1</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'B-cells***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'B-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2919×1&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>2</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Dendritic-cells***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Dendritic-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2516×1&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>3</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Endothelial-cells***Joint'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Endothelial-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Joint'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1737×1&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>4</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Endothelial-cells***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Endothelial-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2460×1&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>5</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Erythrocytes***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Erythrocytes'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>3211×1&nbsp;cell</span></td></tr></tbody></table></div></div></div></div></div></div><h4  class = 'S9' id = 'H_CCE50919' ><span>Load CIA_Ps and CIA_SPs from connective pathway analysis</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SPhv</span><span> = readtable(path_cpa);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SPhv.subprograms = cellfun(@(x) sprintf(</span><span style="color: rgb(170, 4, 249);">'1.%s'</span><span>,x), strtrim(cellstr(num2str(SPhv.subclusters))),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SP = table(unique(SPhv.subprograms),</span><span style="color: rgb(170, 4, 249);">'variablenames'</span><span>,{</span><span style="color: rgb(170, 4, 249);">'SP'</span><span>});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>z = 1 : length(SP.SP)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    SP.AllMolecules{z} = unique(regexp(strjoin(SPhv.AllMolecules(strcmp(SPhv.subprograms,SP.SP{z})),</span><span style="color: rgb(170, 4, 249);">','</span><span>),</span><span style="color: rgb(170, 4, 249);">'\,'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SP.SP(length(SP.SP)+1)={</span><span style="color: rgb(170, 4, 249);">'P1'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SP.AllMolecules{end} = unique(regexp(strjoin(SPhv.AllMolecules(SPhv.clustersGlobal==1),</span><span style="color: rgb(170, 4, 249);">','</span><span>),</span><span style="color: rgb(170, 4, 249);">'\,'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SP.SP(length(SP.SP)+1)={</span><span style="color: rgb(170, 4, 249);">'P2'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>SP.AllMolecules{end} = unique(regexp(strjoin(SPhv.AllMolecules(SPhv.clustersGlobal==2),</span><span style="color: rgb(170, 4, 249);">','</span><span>),</span><span style="color: rgb(170, 4, 249);">'\,'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>head(SP, 5)</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableTableElement" uid="BF59B8A8" data-testid="output_1" style="width: 925px;"><div class="ClientDocument veSpecifier dijitContentPane document table" id="variableeditor_peer_RemoteDocument_81" widgetid="variableeditor_peer_RemoteDocument_81" tabindex="0" data-update-plain-text-string="true"><div class="summaryBar" style="font-size: 12px; font-family: Consolas, Inconsolata, Menlo, monospace;"><span>ans = </span><span style="color: rgb(179, 179, 179); font-style: normal;">5×2 table </span></div><div id="variableeditor_peer_RemoteTableViewModel_79" widgetid="variableeditor_peer_RemoteTableViewModel_79" class="table ClientViewDiv hasSummaryBar" data-viewid="__1"><table cellspacing="0" style="border-spacing: 0px; border-width: 0px 1px 0px 0px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><thead><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>&nbsp;</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>SP</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>AllMolecules</span></th></tr></thead><tbody><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>1</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.1'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×393&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>2</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.10'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×108&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>3</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.2'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×716&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>4</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.3'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×247&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>5</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.4'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×351&nbsp;cell</span></td></tr></tbody></table></div></div></div></div></div></div><div  class = 'S13'><span></span></div><h4  class = 'S16' id = 'H_BBBEC1DE' ><span>load URs from Niche net</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR = readtable(path_URs);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR(UR.pearson&lt;0,:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.senderOrgan = cellfun(@(x) x{2}, regexp(UR.Sender,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.targetOrgan = cellfun(@(x) x{2}, regexp(UR.Target,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR(~strcmp(UR.senderOrgan,UR.targetOrgan),:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR(~ismember(UR.senderOrgan,{</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>,</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>}),:)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.targetcell = cellfun(@(x) x{1}, regexp(UR.Target,</span><span style="color: rgb(170, 4, 249);">'\_'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>),</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR = unique(UR(:,{</span><span style="color: rgb(170, 4, 249);">'test_ligand'</span><span>,</span><span style="color: rgb(170, 4, 249);">'targetcell'</span><span>,</span><span style="color: rgb(170, 4, 249);">'targetOrgan'</span><span>,</span><span style="color: rgb(170, 4, 249);">'target'</span><span>}));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.Properties.VariableNames = {</span><span style="color: rgb(170, 4, 249);">'UR'</span><span>,</span><span style="color: rgb(170, 4, 249);">'cell_dataset'</span><span>,</span><span style="color: rgb(170, 4, 249);">'condition'</span><span>,</span><span style="color: rgb(170, 4, 249);">'DS'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.DS = regexp(UR.DS,</span><span style="color: rgb(170, 4, 249);">'\/'</span><span>,</span><span style="color: rgb(170, 4, 249);">'split'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.group(strcmp(UR.condition,</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>)) = {</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.group(strcmp(UR.condition,</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>)) = {</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR.key = cellfun(@(x,y) sprintf(</span><span style="color: rgb(170, 4, 249);">'%s***%s'</span><span>,x,y),UR.cell_dataset,UR.group,</span><span style="color: rgb(170, 4, 249);">'UniformOutput'</span><span>,0);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>UR = UR(:,{</span><span style="color: rgb(170, 4, 249);">'UR'</span><span>,</span><span style="color: rgb(170, 4, 249);">'key'</span><span>,</span><span style="color: rgb(170, 4, 249);">'cell_dataset'</span><span>,</span><span style="color: rgb(170, 4, 249);">'group'</span><span>,</span><span style="color: rgb(170, 4, 249);">'DS'</span><span>});</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>head(UR, 5)</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableTableElement" uid="18530C50" data-testid="output_2" style="width: 925px;"><div class="ClientDocument veSpecifier dijitContentPane document table" id="variableeditor_peer_RemoteDocument_82" widgetid="variableeditor_peer_RemoteDocument_82" tabindex="0" data-update-plain-text-string="true"><div class="summaryBar" style="font-size: 12px; font-family: Consolas, Inconsolata, Menlo, monospace;"><span>ans = </span><span style="color: rgb(179, 179, 179); font-style: normal;">5×5 table </span></div><div id="variableeditor_peer_RemoteTableViewModel_80" widgetid="variableeditor_peer_RemoteTableViewModel_80" class="table ClientViewDiv hasSummaryBar" data-viewid="__1"><table cellspacing="0" style="border-spacing: 0px; border-width: 0px 1px 0px 0px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><thead><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>&nbsp;</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>UR</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>key</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>cell_dataset</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>group</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>DS</span></th></tr></thead><tbody><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>1</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'B-cells***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'B-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×64&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>2</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Dendritic-cells***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Dendritic-cells'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×50&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>3</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Erythrocytes***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Erythrocytes'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×69&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>4</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Granulocytes***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Granulocytes'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×24&nbsp;cell</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>5</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Macrophages***Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Macrophages'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'Muscle'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1×18&nbsp;cell</span></td></tr></tbody></table></div></div></div></div></div></div><div  class = 'S13'><span></span></div><h2  class = 'S8' id = 'H_C543E7C0' ><span>Main analysis </span></h2><h4  class = 'S9' id = 'H_DB504A76' ><span>Fisher test enrichment of UR DS in SPs:</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FPval = cell(length(SP.SP),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FOR = cell(length(SP.SP),1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>uUR = unique(UR.UR);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>p = 1 : length(SP.SP)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>cd = 1 : length(Fn.key)               </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            spgenes = SP.AllMolecules{p}(ismember(SP.AllMolecules{p},Fn.DEG{cd}));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            URhv = UR(strcmp(UR.key,Fn.key{cd}),:); </span><span style="color: rgb(2, 128, 9);">%!!!!! URs from more datasets - solved .key now correspond to datasets</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(14, 0, 255);">for </span><span>ur = 1 : length(uUR)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                </span><span style="color: rgb(14, 0, 255);">if </span><span>sum(strcmp(URhv.UR,uUR{ur}))</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    </span><span style="color: rgb(14, 0, 255);">if </span><span>length(unique(Fn.DEG{cd})) ~= length(Fn.DEG{cd})</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                        error = p;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    urds = URhv.DS{strcmp(URhv.UR,uUR{ur})}; </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    a = sum(ismember(spgenes,urds));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    b = sum(~ismember(spgenes,urds));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    c = sum(~ismember(urds,spgenes));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    d = sum(~ismember(Fn.DEG{cd},[spgenes,urds]));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    [~, FPval{p}(cd,ur)] = fishertest([a b; c d],</span><span style="color: rgb(170, 4, 249);">'tail'</span><span>,</span><span style="color: rgb(170, 4, 249);">'right'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    FOR{p}(cd,ur) = (a*d)/(b*c);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    FPval{p}(cd,ur) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    FOR{p}(cd,ur) = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                clear </span><span style="color: rgb(170, 4, 249);">urds a b c d</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            clear </span><span style="color: rgb(170, 4, 249);">spgenes</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Summarize results</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.cellsdes = SP;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.rowdes = Fn;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.coldes_URs = uUR;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.moreURinfo = UR;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.Pval = FPval;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>FishertestR.OR = FOR;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>FishertestR</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableStringElement" uid="40D1D32C" data-testid="output_3" data-width="895" data-height="104" data-hashorizontaloverflow="false" style="width: 925px; max-height: 261px;"><div class="textElement"><div><span class="variableNameElement">FishertestR = <span class="headerElement">struct with fields:</span></span></div><div>      cellsdes: [12×2 table]
        rowdes: [18×4 table]
    coldes_URs: {31×1 cell}
    moreURinfo: [123×5 table]
          Pval: {12×1 cell}
            OR: {12×1 cell}
</div></div></div></div></div></div><div  class = 'S13'><span></span></div><h4  class = 'S16' id = 'H_2E8C639C' ><span>combine pvalues over joint and muscle:</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% For each program and UR, use Fisher's method to combine pvals over all cell types </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>p = 1 : length(FishertestR.Pval)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>ur = 1 : size(FishertestR.Pval{p},2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        joint_idx = strcmp(FishertestR.rowdes.group,</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        chi = -2*sum(log(FishertestR.Pval{p}(joint_idx,ur)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte436651325">CombinedPval_joint</span><span>(p,ur) = my_chi2cdf(chi,2*sum(joint_idx));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        muscle_idx = strcmp(FishertestR.rowdes.group,</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        chi = -2*sum(log(FishertestR.Pval{p}(muscle_idx,ur)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte436651325">CombinedPval_muscle</span><span>(p,ur) = my_chi2cdf(chi,2*sum(muscle_idx));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        chi = -2*sum(log(FishertestR.Pval{p}(:,ur)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte436651325">CombinedPval_all</span><span>(p,ur) = my_chi2cdf(chi,2*32);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% Create a summary file where we store important results</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.cols_URs = FishertestR.coldes_URs;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.rows_SPs = FishertestR.cellsdes.SP;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint = CombinedPval_joint;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_muscle = CombinedPval_muscle;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_all = CombinedPval_all;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableStringElement" uid="E2A6B4EF" data-testid="output_4" data-width="895" data-height="90" data-hashorizontaloverflow="false" style="width: 925px; max-height: 261px;"><div class="textElement"><div><span class="variableNameElement">CombinedOverJointandMuscle = <span class="headerElement">struct with fields:</span></span></div><div>        cols_URs: {31×1 cell}
        rows_SPs: {12×1 cell}
     CombP_joint: [12×31 double]
    CombP_muscle: [12×31 double]
       CombP_all: [12×31 double]
</div></div></div></div></div></div><div  class = 'S13'><span></span></div><h4  class = 'S16' id = 'H_BC696F3B' ><span>FDR correction over Programs</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% For each program and UR, do FDR correction </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i = 1:length(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint(:,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte436651325">FDR_joint</span><span>(i,:) = mafdr(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint(i,:), </span><span style="color: rgb(170, 4, 249);">'BHFDR'</span><span>,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte436651325">FDR_muscle</span><span>(i,:) = mafdr(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_muscle(i,:), </span><span style="color: rgb(170, 4, 249);">'BHFDR'</span><span>,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte436651325">FDR_all</span><span>(i,:) = mafdr(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_all(i,:), </span><span style="color: rgb(170, 4, 249);">'BHFDR'</span><span>,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Joint = FDR_joint;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Muscle = FDR_muscle;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_All = FDR_all;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableStringElement" uid="9E457D70" data-testid="output_5" data-width="895" data-height="132" data-hashorizontaloverflow="false" style="width: 925px; max-height: 261px;"><div class="textElement"><div><span class="variableNameElement">CombinedOverJointandMuscle = <span class="headerElement">struct with fields:</span></span></div><div>        cols_URs: {31×1 cell}
        rows_SPs: {12×1 cell}
     CombP_joint: [12×31 double]
    CombP_muscle: [12×31 double]
       CombP_all: [12×31 double]
       FDR_Joint: [12×31 double]
      FDR_Muscle: [12×31 double]
         FDR_All: [12×31 double]
</div></div></div></div></div></div><div  class = 'S13'><span></span></div><div  class = 'S4'><span></span></div><h4  class = 'S16' id = 'H_0BDB29FB' ><span>Count significant pvalues over joints and muscles:</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">% For each program and UR, count how in how many cell types was UR significant </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>p = 1 : length(FishertestR.Pval)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">for </span><span>ur = 1 : size(FishertestR.Pval{p},2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        joint_idx = strcmp(FishertestR.rowdes.group,</span><span style="color: rgb(170, 4, 249);">'Joint'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        pvals_corrected_joint = mafdr(FishertestR.Pval{p}(joint_idx,ur), </span><span style="color: rgb(170, 4, 249);">'BHFDR'</span><span>,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte436651325">count_joint</span><span>(p,ur) = sum(pvals_corrected_joint&lt;0.05);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(2, 128, 9);">%datasets_joint(p,ur,:) = pvals_corrected_joint&lt;0.05;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        muscle_idx = strcmp(FishertestR.rowdes.group,</span><span style="color: rgb(170, 4, 249);">'Muscle'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        pvals_corrected_muscle = mafdr(FishertestR.Pval{p}(muscle_idx,ur), </span><span style="color: rgb(170, 4, 249);">'BHFDR'</span><span>,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span class="warning_squiggle_rte436651325">count_muscle</span><span>(p,ur) = sum(pvals_corrected_muscle&lt;0.05);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(2, 128, 9);">%datasets_muscle(p,ur,:) = pvals_corrected_muscle&lt;0.05;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_joint = count_joint;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_muscle = count_muscle;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span class="variableHighlight">CombinedOverJointandMuscle</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableStringElement" uid="57919CCF" data-testid="output_6" data-width="895" data-height="160" data-hashorizontaloverflow="false" style="width: 925px; max-height: 261px;"><div class="textElement"><div><span class="variableNameElement">CombinedOverJointandMuscle = <span class="headerElement">struct with fields:</span></span></div><div>        cols_URs: {31×1 cell}
        rows_SPs: {12×1 cell}
     CombP_joint: [12×31 double]
    CombP_muscle: [12×31 double]
       CombP_all: [12×31 double]
       FDR_Joint: [12×31 double]
      FDR_Muscle: [12×31 double]
         FDR_All: [12×31 double]
     count_joint: [12×31 double]
    count_muscle: [12×31 double]
</div></div></div></div></div></div><div  class = 'S13'><span></span></div><h2  class = 'S8' id = 'H_C7F41035' ><span>Final output</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>CombinedPval  = table(repmat(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.rows_SPs,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    repelem(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.cols_URs,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint,1)),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_joint,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_muscle,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_muscle,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_muscle,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_all,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_all,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.CombP_all,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Joint,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Joint,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Joint,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Muscle,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Muscle,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_Muscle,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_All,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_All,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.FDR_All,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_joint,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_joint,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_joint,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    reshape(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_muscle,size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_muscle,1)*size(</span><span class="variableHighlight">CombinedOverJointandMuscle</span><span>.count_muscle,2),1),</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                    </span><span style="color: rgb(170, 4, 249);">'variablenames'</span><span>,{</span><span style="color: rgb(170, 4, 249);">'SP'</span><span>,</span><span style="color: rgb(170, 4, 249);">'UR'</span><span>,</span><span style="color: rgb(170, 4, 249);">'CombinedP_Joint'</span><span>,</span><span style="color: rgb(170, 4, 249);">'CombinedP_Muscle'</span><span>, </span><span style="color: rgb(170, 4, 249);">'CombinedP_All'</span><span>, </span><span style="color: rgb(170, 4, 249);">'FDR_Joint'</span><span>, </span><span style="color: rgb(170, 4, 249);">'FDR_Muscle'</span><span>, </span><span style="color: rgb(170, 4, 249);">'FDR_All'</span><span>, </span><span style="color: rgb(170, 4, 249);">'count_Joint'</span><span>, </span><span style="color: rgb(170, 4, 249);">'count_Muscle'</span><span>});</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>head(CombinedPval, 5)</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsVariableTableElement" uid="B54D3A6F" data-testid="output_7" style="width: 925px;"><div class="ClientDocument veSpecifier dijitContentPane document table" id="variableeditor_peer_RemoteDocument_83" widgetid="variableeditor_peer_RemoteDocument_83" tabindex="0" data-update-plain-text-string="true"><div class="summaryBar" style="font-size: 12px; font-family: Consolas, Inconsolata, Menlo, monospace;"><span>ans = </span><span style="color: rgb(179, 179, 179); font-style: normal;">5×10 table </span></div><div id="variableeditor_peer_RemoteTableViewModel_81" widgetid="variableeditor_peer_RemoteTableViewModel_81" class="table ClientViewDiv hasSummaryBar" data-viewid="__1"><table cellspacing="0" style="border-spacing: 0px; border-width: 0px 1px 0px 0px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><thead><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>&nbsp;</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>SP</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>UR</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>CombinedP_Joint</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>CombinedP_Muscle</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>CombinedP_All</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>FDR_Joint</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>FDR_Muscle</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>FDR_All</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>count_Joint</span></th><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: center; border-width: 1px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>count_Muscle</span></th></tr></thead><tbody><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>1</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.1'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>4.5845e-20</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>9.1843e-09</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.4212e-18</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2.8471e-07</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>7</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>2</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.10'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>9.9784e-01</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>3</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.2'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.9419e-22</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.9182e-10</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.5050e-21</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.4866e-09</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>7</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>4</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.3'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0711e-26</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.3463e-13</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.1068e-25</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0434e-12</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>7</span></td></tr><tr><th style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 9px; overflow: hidden; width: 34px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial; background: rgb(245, 245, 245); color: rgb(128, 128, 128); padding: 3px;"><span>5</span></th><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'1.4'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 75px; min-width: 75px; max-width: 75px; text-align: left; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>'APOE'</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 149px; min-width: 149px; max-width: 149px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 157px; min-width: 157px; max-width: 157px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2.6564e-24</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 135px; min-width: 135px; max-width: 135px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>8.3587e-12</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 105px; min-width: 105px; max-width: 105px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>1.0000e+00</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 112px; min-width: 112px; max-width: 112px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>2.7449e-23</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 90px; min-width: 90px; max-width: 90px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>6.4780e-11</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 120px; min-width: 120px; max-width: 120px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>0</span></td><td style="text-overflow: ellipsis; font-family: Arial, sans-serif; font-size: 12px; overflow: hidden; width: 127px; min-width: 127px; max-width: 127px; text-align: right; border-width: 0px 0px 1px 1px; border-style: solid; border-color: rgb(191, 191, 191); border-image: initial;"><span>7</span></td></tr></tbody></table></div></div></div></div></div></div><div  class = 'S13'><span></span></div><h4  class = 'S16' id = 'H_2899577C' ><span>Save the data</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(2, 128, 9);">%writetable(CombinedPval,path_output)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% UR enrichment analysis of CIA
%% 
% 

clear all
close all
clc
warning('off', 'all')
%% Input requirements
% For this analysis we will need:
%% 
% * DEGs computed by (TODO link!)
% * Orthologous translation
% * Results from the connective pathway analysis (TODO link!)
% * Predicted URs and their downstreamers from Niche Net (TODO link!)
% We can find the files at following locations:

% DEGs
path_DEGs = '../data/CIA_mouse_DEGs/';
% translation
path_translation = '../data/Connective_pathway_analysis/orthologous_translation_NicheNet_analysis.txt';
% connective pathway analysis
path_cpa = '../data/Connective_pathway_analysis/TreeStructure_nodes2_scRNAseq.txt';
% URs 
path_URs = '../data/Connective_pathway_analysis/all_outgoing_ligand_activity.txt';
% We will produce
% A table with combined, FDR corrected pvalues and the count of significant 
% p values across all cell types for each program/subprogram and UR 
% We will save the file here:

path_output = '../data/UR_analysis/UR_predictions_CIA_disease_Pvals.xlsx';
%% 
% 
%% Prepare the data
% 
% Load DEGs and translate the gene names to human orthologous.


Fn = struct2cell(dir(path_DEGs));
Fn(2:end,:)=[];
Fn(~contains(Fn,'.csv'))=[];
Fn = table(Fn','variablenames',{'fn'});
Fn.Cell = cellfun(@(x) x{5}, regexp(Fn.fn,'\_','split'),'UniformOutput',0);
Fn.Organ = cellfun(@(x) x{6}(1:end-4), regexp(Fn.fn,'\_','split'),'UniformOutput',0);
Fn(~ismember(Fn.Organ,{'Joint','Muscle'}),:)=[];

translation = readtable(path_translation);
for z = 1 : length(Fn.fn)
   hv =readtable(sprintf('%s%s',path_DEGs,Fn.fn{z}));
   hv(~strcmp(hv.is_de_fdr_0_05,'True'),:)=[];
   xx= unique(translation(ismember(translation.Mouse_gene_name,hv.Var1),:));
   Fn.DEG{z} = xx.Gene_name;
   clear hv xx
end

% Restructure the data
Fn.cell_dataset = cellfun(@(x) x{5},regexp(Fn.fn,'\_','split'),'UniformOutput',0);
Fn.Properties.VariableNames(strcmp(Fn.Properties.VariableNames,'Organ'))={'Organ_condition'};
Fn.group = repmat({'Joint'},length(Fn.fn),1);
Fn.group(strcmp(Fn.Organ_condition,'Muscle'))={'Muscle'};
Fn.key = cellfun(@(x,y) sprintf('%s***%s',x,y),Fn.cell_dataset,Fn.group,'UniformOutput',0);

Fn = Fn(:,{'key','cell_dataset','group','DEG'});

head(Fn, 5)
% Load CIA_Ps and CIA_SPs from connective pathway analysis



SPhv = readtable(path_cpa);
SPhv.subprograms = cellfun(@(x) sprintf('1.%s',x), strtrim(cellstr(num2str(SPhv.subclusters))),'UniformOutput',0);
SP = table(unique(SPhv.subprograms),'variablenames',{'SP'});
for z = 1 : length(SP.SP)
    SP.AllMolecules{z} = unique(regexp(strjoin(SPhv.AllMolecules(strcmp(SPhv.subprograms,SP.SP{z})),','),'\,','split'));
end

SP.SP(length(SP.SP)+1)={'P1'};
SP.AllMolecules{end} = unique(regexp(strjoin(SPhv.AllMolecules(SPhv.clustersGlobal==1),','),'\,','split'));
SP.SP(length(SP.SP)+1)={'P2'};
SP.AllMolecules{end} = unique(regexp(strjoin(SPhv.AllMolecules(SPhv.clustersGlobal==2),','),'\,','split'));

head(SP, 5)
%% 
% 
% load URs from Niche net



UR = readtable(path_URs);
UR(UR.pearson<0,:)=[];
UR.senderOrgan = cellfun(@(x) x{2}, regexp(UR.Sender,'\_','split'),'UniformOutput',0);
UR.targetOrgan = cellfun(@(x) x{2}, regexp(UR.Target,'\_','split'),'UniformOutput',0);
UR(~strcmp(UR.senderOrgan,UR.targetOrgan),:)=[];
UR(~ismember(UR.senderOrgan,{'Muscle','Joint'}),:)=[];
UR.targetcell = cellfun(@(x) x{1}, regexp(UR.Target,'\_','split'),'UniformOutput',0);
UR = unique(UR(:,{'test_ligand','targetcell','targetOrgan','target'}));
UR.Properties.VariableNames = {'UR','cell_dataset','condition','DS'};
UR.DS = regexp(UR.DS,'\/','split');
UR.group(strcmp(UR.condition,'Muscle')) = {'Muscle'};
UR.group(strcmp(UR.condition,'Joint')) = {'Joint'};
UR.key = cellfun(@(x,y) sprintf('%s***%s',x,y),UR.cell_dataset,UR.group,'UniformOutput',0);
UR = UR(:,{'UR','key','cell_dataset','group','DS'});
head(UR, 5)
%% 
% 
%% Main analysis 
% Fisher test enrichment of UR DS in SPs:


FPval = cell(length(SP.SP),1);
FOR = cell(length(SP.SP),1);


uUR = unique(UR.UR);
for p = 1 : length(SP.SP)
    for cd = 1 : length(Fn.key)               
            spgenes = SP.AllMolecules{p}(ismember(SP.AllMolecules{p},Fn.DEG{cd}));
            URhv = UR(strcmp(UR.key,Fn.key{cd}),:); %!!!!! URs from more datasets - solved .key now correspond to datasets

            for ur = 1 : length(uUR)
                if sum(strcmp(URhv.UR,uUR{ur}))
                    if length(unique(Fn.DEG{cd})) ~= length(Fn.DEG{cd})
                        error = p;
                    end

                    urds = URhv.DS{strcmp(URhv.UR,uUR{ur})}; 

                    a = sum(ismember(spgenes,urds));
                    b = sum(~ismember(spgenes,urds));
                    c = sum(~ismember(urds,spgenes));
                    d = sum(~ismember(Fn.DEG{cd},[spgenes,urds]));

                    [~, FPval{p}(cd,ur)] = fishertest([a b; c d],'tail','right');
                    FOR{p}(cd,ur) = (a*d)/(b*c);
                else
                    FPval{p}(cd,ur) = 1;
                    FOR{p}(cd,ur) = 0;
                end

                clear urds a b c d
            end
            clear spgenes
    end
end

% Summarize results
FishertestR.cellsdes = SP;
FishertestR.rowdes = Fn;
FishertestR.coldes_URs = uUR;
FishertestR.moreURinfo = UR;
FishertestR.Pval = FPval;
FishertestR.OR = FOR;
FishertestR
%% 
% 
% combine pvalues over joint and muscle:



% For each program and UR, use Fisher's method to combine pvals over all cell types 
for p = 1 : length(FishertestR.Pval)
    for ur = 1 : size(FishertestR.Pval{p},2)
        joint_idx = strcmp(FishertestR.rowdes.group,'Joint');
        chi = -2*sum(log(FishertestR.Pval{p}(joint_idx,ur)));
        CombinedPval_joint(p,ur) = my_chi2cdf(chi,2*sum(joint_idx));
        
        muscle_idx = strcmp(FishertestR.rowdes.group,'Muscle');
        chi = -2*sum(log(FishertestR.Pval{p}(muscle_idx,ur)));
        CombinedPval_muscle(p,ur) = my_chi2cdf(chi,2*sum(muscle_idx));
        
        chi = -2*sum(log(FishertestR.Pval{p}(:,ur)));
        CombinedPval_all(p,ur) = my_chi2cdf(chi,2*32);
    end
end


% Create a summary file where we store important results
CombinedOverJointandMuscle.cols_URs = FishertestR.coldes_URs;
CombinedOverJointandMuscle.rows_SPs = FishertestR.cellsdes.SP;
CombinedOverJointandMuscle.CombP_joint = CombinedPval_joint;
CombinedOverJointandMuscle.CombP_muscle = CombinedPval_muscle;
CombinedOverJointandMuscle.CombP_all = CombinedPval_all;
CombinedOverJointandMuscle
%% 
% 
% FDR correction over Programs



% For each program and UR, do FDR correction 
for i = 1:length(CombinedOverJointandMuscle.CombP_joint(:,1))
    FDR_joint(i,:) = mafdr(CombinedOverJointandMuscle.CombP_joint(i,:), 'BHFDR',true);
    FDR_muscle(i,:) = mafdr(CombinedOverJointandMuscle.CombP_muscle(i,:), 'BHFDR',true);
    FDR_all(i,:) = mafdr(CombinedOverJointandMuscle.CombP_all(i,:), 'BHFDR',true);

end

CombinedOverJointandMuscle.FDR_Joint = FDR_joint;
CombinedOverJointandMuscle.FDR_Muscle = FDR_muscle;
CombinedOverJointandMuscle.FDR_All = FDR_all;

CombinedOverJointandMuscle
%% 
% 
% 
% 
% Count significant pvalues over joints and muscles:



% For each program and UR, count how in how many cell types was UR significant 
for p = 1 : length(FishertestR.Pval)
    for ur = 1 : size(FishertestR.Pval{p},2)
        joint_idx = strcmp(FishertestR.rowdes.group,'Joint');
        pvals_corrected_joint = mafdr(FishertestR.Pval{p}(joint_idx,ur), 'BHFDR',true);
        count_joint(p,ur) = sum(pvals_corrected_joint<0.05);
        %datasets_joint(p,ur,:) = pvals_corrected_joint<0.05;
        
        muscle_idx = strcmp(FishertestR.rowdes.group,'Muscle');
        pvals_corrected_muscle = mafdr(FishertestR.Pval{p}(muscle_idx,ur), 'BHFDR',true);
        count_muscle(p,ur) = sum(pvals_corrected_muscle<0.05);
        %datasets_muscle(p,ur,:) = pvals_corrected_muscle<0.05;

    end
end

CombinedOverJointandMuscle.count_joint = count_joint;
CombinedOverJointandMuscle.count_muscle = count_muscle;

CombinedOverJointandMuscle
%% 
% 
%% Final output


CombinedPval  = table(repmat(CombinedOverJointandMuscle.rows_SPs,size(CombinedOverJointandMuscle.CombP_joint,2),1),...
                    repelem(CombinedOverJointandMuscle.cols_URs,size(CombinedOverJointandMuscle.CombP_joint,1)),...
                    reshape(CombinedOverJointandMuscle.CombP_joint,size(CombinedOverJointandMuscle.CombP_joint,1)*size(CombinedOverJointandMuscle.CombP_joint,2),1),...
                    reshape(CombinedOverJointandMuscle.CombP_muscle,size(CombinedOverJointandMuscle.CombP_muscle,1)*size(CombinedOverJointandMuscle.CombP_muscle,2),1),...
                    reshape(CombinedOverJointandMuscle.CombP_all,size(CombinedOverJointandMuscle.CombP_all,1)*size(CombinedOverJointandMuscle.CombP_all,2),1),...
                    reshape(CombinedOverJointandMuscle.FDR_Joint,size(CombinedOverJointandMuscle.FDR_Joint,1)*size(CombinedOverJointandMuscle.FDR_Joint,2),1),...
                    reshape(CombinedOverJointandMuscle.FDR_Muscle,size(CombinedOverJointandMuscle.FDR_Muscle,1)*size(CombinedOverJointandMuscle.FDR_Muscle,2),1),...
                    reshape(CombinedOverJointandMuscle.FDR_All,size(CombinedOverJointandMuscle.FDR_All,1)*size(CombinedOverJointandMuscle.FDR_All,2),1),...
                    reshape(CombinedOverJointandMuscle.count_joint,size(CombinedOverJointandMuscle.count_joint,1)*size(CombinedOverJointandMuscle.count_joint,2),1),...
                    reshape(CombinedOverJointandMuscle.count_muscle,size(CombinedOverJointandMuscle.count_muscle,1)*size(CombinedOverJointandMuscle.count_muscle,2),1),...
                    'variablenames',{'SP','UR','CombinedP_Joint','CombinedP_Muscle', 'CombinedP_All', 'FDR_Joint', 'FDR_Muscle', 'FDR_All', 'count_Joint', 'count_Muscle'});
head(CombinedPval, 5)
%% 
% 
% Save the data

%writetable(CombinedPval,path_output)
##### SOURCE END #####
--></body></html>